{% extends "base.html" %}
{% load filters %}
{% load static %}

{% block nav %}
{% endblock %}

{% block content %}
    <div class="content huge-content">
        <h1 class="page-title">Transactions</h1>
        <div class="table">
            <table>
                <thead>
                    <th>Date</th>
                    <th>Vendor</th>
                    <th>Reason</th>
                    <th>Method</th>
                    <th>Category</th>
                    <th>Amount</th>
                </thead>
                <form method="post" id="listTransactionsForm" action="{% url 'transactions' %}">
                    {% csrf_token %}
                    <tr>
                        <td><input type="date" name="date" id="listTransactionsFilterDate"><button type="submit" form="listTransactionsForm" class="btn btn-stealth icon-right"><i class="bi-arrow-return-left"></i></button></td>
                        <td><input type="text" oninput="onVendorChange(event)" name="vendor" id="listTransactionsFilterVendor"><button class="btn btn-stealth icon-right"><i class="bi-arrow-return-left"></i></button></td>
                        <td><input type="text" name="reason" id="listTransactionsFilterReason"><button class="btn btn-stealth icon-right"><i class="bi-arrow-return-left"></i></button></td>
                        <td>
                            <select name="method" id="listTransactionsFilterMethod">
                                {% for method in methods %}
                                    <option value="{{ method.id }}" label="{{ method.name }}"></option>
                                {% endfor %}
                            </select>
                            <button class="btn btn-stealth icon-right"><i class="bi-arrow-return-left"></i></button>
                        </td>
                        <td>
                            <select name="category" id="listTransactionsFilterCategory">
                                {% for category in categories %}
                                    <option value="{{ category.id }}" label="{{ category.name }}"></option>
                                {% endfor %}
                            </select>
                            <button class="btn btn-stealth icon-right"><i class="bi-arrow-return-left"></i></button>
                        </td>
                        <td></td>
                    </tr>
                </form>
                
                {% for transaction in transactions %}
                    <tr class="clickable" onclick="window.location = '/transactions/{{transaction.id}}?prevUrl=transactions'">
                        <td>{{ transaction.dateStr }}</td>
                        <td>{{ transaction.vendor }}</td>
                        <td>{{ transaction.reason }}</td>
                        <td>{{ transaction.method }}</td>
                        <td>{{ transaction.category }}</td>
                        <td class="accounting">{{ transaction.amountStr|spacify }}</td>
                    </tr>
                {% endfor %}
            </table>
        </div>
        <p>Showing {{ transactions.count }} transactions</p>
        {% if not hideShowMore %}
                <a href="?show={{ nextNumToShow }}" class="btn btn-primary">Show More<i class="bi bi-plus-lg icon-right"></i></a>
        {% endif %}
        <script type="text/javascript" src="{% static 'tracker/listTransactions.js' %}"></script>
    </div>
{% endblock %}